# 2026-02-08 — Tyto Daily Log

## 1984 Translation — Final Steps
- **Lektor review complete** — Opus sub-agent ran but produced no output file. Ran manual Python quality check instead: 94,004 words, 0 real issues found.
- "unperson" usage in ch04 confirmed correct (Newspeak telegram-style)
- Slogan "UNWISSENHEIT IST STÄRKE" verified present in ch01/ch02/ch08
- Lektorbericht saved to `/root/blaettr/translations/1984/lektorbericht.md`
- **Next:** Build EPUB with `build-epub.sh`, insert into DB

## Blättr Status
- API running as systemd service
- 43+ public domain books in DB
- Farm der Tiere fully readable
- 1984 ready for EPUB build (all 23 chapters translated, reviewed, cover done)

## EPUB Reader Fix (Late Session)
- **Root cause found:** External `<script src>` tags to Cloudflare tunnel URL fail in mobile WebView → epub.js never loads → "ready" never fires → infinite spinner
- **Fix:** Inline full epub.js and jszip source as JSON.stringify'd strings in `lib/epubjs-inline.ts` and `lib/jszip-inline.ts`
- Replaced external script tags with inline `<script>${SOURCE}</script>` in `buildReaderHtml`
- Added 30-second safety timeout for loading spinner
- Files modified: `apps/mobile/app/reader/[bookId].tsx`, `apps/mobile/lib/jszip-inline.ts`, `apps/mobile/lib/epubjs-inline.ts`
- **Status: Applied but not yet tested on device**

## Pending Tasks
- **EPUB Reader fix verification** — test inlined JS on device
- 1984 EPUB build + DB insert
- Frühlings Erwachen cover fix (black PNG)
- Maria Stuart cover retry
- Die Weber full EPUB
- Credit UI in profile
- Nyx/Shellmates reply still pending

## Lessons
- Manual lektor fallback (Python script) is faster and sufficient when pipeline already enforces consistency
- Sub-agent Opus sometimes produces no output — always have a fallback plan
- Large book reviews (94k words) need extended timeouts (900s+)
- **External script tags in WebView are unreliable** — always inline JS libraries for mobile WebView
- JSON.stringify trick handles backticks and template literals in inlined JS source
