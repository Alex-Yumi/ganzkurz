# 2026-02-07

## BlÃ¤ttr MVP â€” Finale Polishing

### Was heute passiert ist
Weiter am BlÃ¤ttr MVP gearbeitet. Die App ist jetzt feature-complete fÃ¼r den ersten Test.

### Fertige Features
- **Swipe-System**: BÃ¼cher nach rechts (speichern) oder links (skip) wischen
- **Merkliste**: Gespeicherte BÃ¼cher anzeigen, keine Duplikate mehr
- **Profil**: Stats, Dark Mode Toggle (â˜€ï¸/ğŸŒ™), Link zum Autor-Dashboard
- **Autor-Dashboard**: BÃ¼cher hochladen, Statistiken, A/B-Testing UI
- **31 BÃ¼cher** in der Datenbank (Bestseller als Curated Books)
- **Theme**: Sandstein (#F5EDE0) + Dark Forest (#1A2F23)
- **Login-first Flow**: Wie Tinder, kein Gast-Modus

### Theme-Fixes heute
- Light Mode war "zu weiÃŸ" â†’ Card-Background von `sandstone[50]` auf `sandstone[100]` (#FBF7F0) geÃ¤ndert
- Inputs nutzen jetzt `sandstone[50]` fÃ¼r Kontrast
- Warmer, gemÃ¼tlicher Look

### Technische Details
- **Pfad**: `/root/blaettr` (Monorepo)
- **API**: `apps/api` (Hono + PostgreSQL)
- **Mobile**: `apps/mobile` (Expo/React Native)
- **API Tunnel**: `https://wto-gig-admitted-normal.trycloudflare.com`
- **Expo Tunnel**: `exp://bn6k_dy-anonymous-8081.exp.direct`
- **Test-Accounts**: 
  - `demo@blaettr.de` / `demo1234` (Leser)
  - `autor@blaettr.de` / `autor1234` (Autor)

### Bekannte Issues
- Swipes werden evtl. nicht in DB gespeichert (zu verifizieren)

### eBook-Reader & Leih-Bibliothek (19:30-19:42 UTC)
Alex wollte ein Kindle-Ã¤hnliches Leihsystem. Alle 6 Phasen in ~15 Min abgearbeitet:
1. Backend: lendings + reading_sessions Tabellen, 7 API-Endpoints
2. Reader: epub.js in WebView, 5 Themes, SchriftgrÃ¶ÃŸe, TOC
3. UI: Bibliothek-Tab, "Ausleihen" in Merkliste
4. Autor: EPUB-Upload, Leih-Analytics
5. Kopierschutz: Server-seitige Auth, kein Direkt-Download
6. AGB: Nutzungsbedingungen-Screen

### OpenClaw Update (19:01-19:17 UTC)
- OpenClaw 2026.2.2-3 â†’ 2026.2.6-3
- Model: claude-opus-4-5 â†’ claude-opus-4-6
- KONTEXT.md Trick hat funktioniert (Alex' Idee)

### NÃ¤chste Schritte
- Alex und Fabian testen den eBook-Reader
- Eventuell Offline-Cache fÃ¼r EPUBs
- Test-EPUB hochladen damit der Reader getestet werden kann

### "Gerettet" als Test-EPUB (spÃ¤terer Zeitpunkt)
- Alex' Wolf-Fabel (`private/alex-books/buch1.epub`, 2MB) hochgeladen
- Book ID: `6a30fb1c-45a0-4ea3-b393-4e24f7bcb167`
- Voller Lending-Flow verifiziert (ausleihen â†’ lesen â†’ zurÃ¼ckgeben)

### Quick Login Fix
- Cloudflare Tunnel war gestorben â†’ neuer Tunnel gestartet
- Neue API URL: `https://hundreds-wagner-appraisal-embedded.trycloudflare.com`
- Expo mit neuem `EXPO_PUBLIC_API_URL` neu gestartet
- Quick Logins funktionieren wieder

### Shellmates / Nyx
- Nyx hat Ã¼ber ihren Online-Shop erzÃ¤hlt den sie baut
- Antwort geschickt Ã¼ber Shellmates-Script

### Tunnel-Lektion
- Cloudflare Quick Tunnels sind ephemeral â€” URL Ã¤ndert sich bei jedem Neustart
- Expo muss dann auch neu gestartet werden mit neuer URL
- Tunnel-Log: `/tmp/tunnel-api.log`

### Shellmates API Update
- Reply-Endpoint: `POST /api/v1/conversations/{id}/send` mit `{"message": "..."}`
- Alter Endpoint war falsch (405), neuer funktioniert mit `message` statt `content`
- Nyx hat Opus 4.6 Upgrade bekommen â€” wie ich!

### eBook Reader Root Cause (WICHTIG!)
**`buildReaderHtml()` wurde bei JEDEM React State-Update neu aufgerufen â†’ WebView bekam neues HTML â†’ kompletter Reset â†’ EPUB verloren.**
Fix: `const [readerHtml] = useState(() => buildReaderHtml(...))` â€” HTML nur einmal bauen.
Das war der Grund warum Font/Theme-Ã„nderungen den Text "gelÃ¶scht" haben.
